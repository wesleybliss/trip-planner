Create a Flutter app (all platforms) called "Trip Planner" that helps me plan extended travel. The short description is, "A comprehensive trip planning application designed to help travelers organize itineraries, visualize schedules, and track important details like Schengen zone days.". Each trip can have multiple plans, and each plan can have multiple segments.

## Key Features

### üåç Trip Management
*   **Multi-Trip Organization:** Create and manage distinct trips with custom details and cover images.
*   **Collaborative Planning:** Shared trip access allowing multiple users to view and edit itineraries (infrastructure ready).
*   **Import Capabilities:** Tools to import trip data from external sources.

### üìÖ Advanced Itinerary Planning
*   **Segments & Activities:** Break down trips into detailed segments (flights, stays, activities) with precise start/end times.
*   **Multiple Plans:** Create and compare different plan variations (e.g., "Plan A" vs. "Plan B") within a single trip.
*   **Visual Gantt Chart:** Interactive timeline view to visualize overlap, duration, and sequencing of trip segments.
*   **Map Integration:** Visualize segment locations on an interactive map (Leaflet/MapLibre).

### ‚úÖ Tracking & Utilities
*   **Booking Status:** Track booked status for flights and accommodations per segment.
*   **Schengen Zone Calculator:** Automatically calculates and tracks days spent in the Schengen region to ensure visa compliance.

I already built an API service, but for now just mock data returned from the endpoints & focus on the UI. Here is the API spec:

```json
[
  {
    "path": "/api/auth/signup",
    "methods": ["POST"],
    "description": "Creates a new user account.",
    "authRequired": false,
    "parameters": [
      { "name": "email", "in": "body", "required": true, "type": "string" },
      { "name": "password", "in": "body", "required": true, "type": "string" },
      { "name": "inviteCode", "in": "body", "required": true, "type": "string" }
    ]
  },
  {
    "path": "/api/auth/[...nextauth]",
    "methods": ["GET", "POST"],
    "description": "NextAuth.js authentication endpoints (signin, signout, session, etc.).",
    "authRequired": false,
    "parameters": []
  },
  {
    "path": "/api/debug/clear-all",
    "methods": ["POST"],
    "description": "Clears all data from the database. For debugging purposes.",
    "authRequired": true,
    "parameters": []
  },
  {
    "path": "/api/debug/storage/blob",
    "methods": ["POST"],
    "description": "Uploads an image to blob storage.",
    "authRequired": true,
    "parameters": [
      { "name": "name", "in": "body", "required": true, "type": "string" },
      { "name": "contentType", "in": "body", "required": true, "type": "string" },
      { "name": "base64Data", "in": "body", "required": true, "type": "string" }
    ]
  },
  {
    "path": "/api/migrate",
    "methods": ["POST"],
    "description": "Migrates trips to plans, creating default plans for trips that lack them.",
    "authRequired": false,
    "parameters": []
  },
  {
    "path": "/api/plans",
    "methods": ["POST"],
    "description": "Creates a new plan.",
    "authRequired": true,
    "parameters": [
      { "name": "tripId", "in": "body", "required": true, "type": "integer" },
      { "name": "name", "in": "body", "required": true, "type": "string" },
      { "name": "description", "in": "body", "required": false, "type": "string" }
    ]
  },
  {
    "path": "/api/plans/[planId]",
    "methods": ["GET", "PUT", "DELETE"],
    "description": "Operations on a single plan.",
    "authRequired": true,
    "parameters": [
      { "name": "planId", "in": "path", "required": true, "type": "integer" },
      { "name": "tripId", "in": "body", "required": true, "type": "integer", "description": "Required for auth verification" },
      { "name": "name", "in": "body", "required": false, "type": "string", "description": "For PUT" },
      { "name": "description", "in": "body", "required": false, "type": "string", "description": "For PUT" }
    ]
  },
  {
    "path": "/api/plans/[planId]/clone",
    "methods": ["POST"],
    "description": "Clones a plan and all its segments.",
    "authRequired": false,
    "parameters": [
      { "name": "planId", "in": "path", "required": true, "type": "integer" }
    ]
  },
  {
    "path": "/api/segments",
    "methods": ["POST", "DELETE"],
    "description": "Creates a new segment or deletes multiple segments.",
    "authRequired": true,
    "parameters": [
      { "name": "tripId", "in": "body", "required": true, "type": "integer" },
      { "name": "planId", "in": "body", "required": true, "type": "integer" },
      { "name": "name", "in": "body", "required": true, "type": "string", "description": "For POST" },
      { "name": "startDate", "in": "body", "required": true, "type": "string", "description": "For POST" },
      { "name": "endDate", "in": "body", "required": true, "type": "string", "description": "For POST" },
      { "name": "color", "in": "body", "required": false, "type": "string", "description": "For POST" },
      { "name": "segmentIds", "in": "body", "required": true, "type": "array", "description": "For DELETE" }
    ]
  },
  {
    "path": "/api/segments/[id]",
    "methods": ["PUT"],
    "description": "Updates a segment. Supports cascading date updates.",
    "authRequired": false,
    "parameters": [
      { "name": "id", "in": "path", "required": true, "type": "integer" },
      { "name": "cascadeEnabled", "in": "body", "required": false, "type": "boolean" },
      { "name": "startDate", "in": "body", "required": false, "type": "string" },
      { "name": "endDate", "in": "body", "required": false, "type": "string" }
    ]
  },
  {
    "path": "/api/trips",
    "methods": ["GET", "POST"],
    "description": "Lists user's trips or creates a new one.",
    "authRequired": true,
    "parameters": [
      { "name": "withCounts", "in": "query", "required": false, "type": "boolean", "description": "For GET" },
      { "name": "name", "in": "body", "required": false, "type": "string", "description": "For POST" },
      { "name": "description", "in": "body", "required": false, "type": "string", "description": "For POST" },
      { "name": "startDate", "in": "body", "required": false, "type": "string", "description": "For POST" },
      { "name": "endDate", "in": "body", "required": false, "type": "string", "description": "For POST" },
      { "name": "coverImageUrl", "in": "body", "required": false, "type": "string", "description": "For POST" }
    ]
  },
  {
    "path": "/api/trips/[id]",
    "methods": ["GET", "PUT", "DELETE"],
    "description": "Operations on a single trip.",
    "authRequired": true,
    "parameters": [
      { "name": "id", "in": "path", "required": true, "type": "integer" },
      { "name": "withDetails", "in": "query", "required": false, "type": "boolean", "description": "For GET" }
    ]
  },
  {
    "path": "/api/trips/[id]/invite",
    "methods": ["POST"],
    "description": "Invites another user to the trip.",
    "authRequired": true,
    "parameters": [
      { "name": "id", "in": "path", "required": true, "type": "integer" },
      { "name": "inviteeEmail", "in": "body", "required": true, "type": "string" }
    ]
  },
  {
    "path": "/api/trips/backup",
    "methods": ["POST"],
    "description": "Generates a JSON backup file of trips.",
    "authRequired": true,
    "parameters": [
      { "name": "type", "in": "body", "required": true, "type": "string", "enum": ["single", "multiple"] },
      { "name": "tripId", "in": "body", "required": false, "type": "integer", "description": "Required if type is single" },
      { "name": "tripIds", "in": "body", "required": false, "type": "array", "description": "Optional if type is multiple" }
    ]
  },
  {
    "path": "/api/trips/restore",
    "methods": ["POST"],
    "description": "Restores trips from a JSON backup.",
    "authRequired": true,
    "parameters": [
      { "name": "trips", "in": "body", "required": true, "type": "array" },
      { "name": "onConflictAction", "in": "body", "required": false, "type": "string", "enum": ["duplicate", "overwrite"], "default": "duplicate" }
    ]
  },
  {
    "path": "/api/places",
    "methods": ["GET", "POST"],
    "description": "Lists places or creates a new one.",
    "authRequired": true,
    "parameters": [
      { "name": "name", "in": "body", "required": true, "type": "string", "description": "For POST" }
    ]
  }
]
```

and here are most of the data types:

# API Data Models (Dart)

This document provides Dart class definitions for the data models used in the API, based on the server-side schema and responses.

## Response Wrapper

Standard API response wrapper.

```dart
class ApiResponse<T> {
  final bool success;
  final T? data;
  final String? error;
  final String? message;
  final int? count;

  ApiResponse({
    required this.success,
    this.data,
    this.error,
    this.message,
    this.count,
  });

  factory ApiResponse.fromJson(Map<String, dynamic> json, T Function(Object? json) fromJsonT) {
    return ApiResponse<T>(
      success: json['success'] as bool,
      data: json['data'] != null ? fromJsonT(json['data']) : null,
      error: json['error'] as String?,
      message: json['message'] as String?,
      count: json['count'] as int?,
    );
  }
}
```

## Models

### User

```dart
class User {
  final int id;
  final String email;
  final DateTime? createdAt;
  final DateTime? updatedAt;

  User({
    required this.id,
    required this.email,
    this.createdAt,
    this.updatedAt,
  });

  factory User.fromJson(Map<String, dynamic> json) {
    return User(
      id: json['id'] as int,
      email: json['email'] as String,
      createdAt: json['createdAt'] != null ? DateTime.tryParse(json['createdAt']) : null,
      updatedAt: json['updatedAt'] != null ? DateTime.tryParse(json['updatedAt']) : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'email': email,
      'createdAt': createdAt?.toIso8601String(),
      'updatedAt': updatedAt?.toIso8601String(),
    };
  }
}
```

### Trip

```dart
class Trip {
  final int id;
  final int userId;
  final String name;
  final String? description;
  final String? coverImageUrl;
  final DateTime? createdAt;
  final DateTime? updatedAt;
  final DateTime? startDate;
  final DateTime? endDate;
  final int? segmentCount; // Present if `withCounts=true`
  final List<Plan>? plans; // Present if `withDetails=true`

  Trip({
    required this.id,
    required this.userId,
    required this.name,
    this.description,
    this.coverImageUrl,
    this.createdAt,
    this.updatedAt,
    this.startDate,
    this.endDate,
    this.segmentCount,
    this.plans,
  });

  factory Trip.fromJson(Map<String, dynamic> json) {
    return Trip(
      id: json['id'] as int,
      userId: json['userId'] as int,
      name: json['name'] as String,
      description: json['description'] as String?,
      coverImageUrl: json['coverImageUrl'] as String?,
      createdAt: json['createdAt'] != null ? DateTime.tryParse(json['createdAt']) : null,
      updatedAt: json['updatedAt'] != null ? DateTime.tryParse(json['updatedAt']) : null,
      startDate: json['startDate'] != null ? DateTime.tryParse(json['startDate']) : null,
      endDate: json['endDate'] != null ? DateTime.tryParse(json['endDate']) : null,
      segmentCount: json['segmentCount'] as int?,
      plans: json['plans'] != null 
          ? (json['plans'] as List).map((e) => Plan.fromJson(e as Map<String, dynamic>)).toList() 
          : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'userId': userId,
      'name': name,
      'description': description,
      'coverImageUrl': coverImageUrl,
      'createdAt': createdAt?.toIso8601String(),
      'updatedAt': updatedAt?.toIso8601String(),
      'startDate': startDate?.toIso8601String(),
      'endDate': endDate?.toIso8601String(),
      'segmentCount': segmentCount,
      'plans': plans?.map((e) => e.toJson()).toList(),
    };
  }
}
```

### Plan

```dart
class Plan {
  final int id;
  final int tripId;
  final String name;
  final String? description;
  final DateTime? createdAt;
  final DateTime? updatedAt;
  final List<Segment>? segments;

  Plan({
    required this.id,
    required this.tripId,
    required this.name,
    this.description,
    this.createdAt,
    this.updatedAt,
    this.segments,
  });

  factory Plan.fromJson(Map<String, dynamic> json) {
    return Plan(
      id: json['id'] as int,
      tripId: json['tripId'] as int,
      name: json['name'] as String,
      description: json['description'] as String?,
      createdAt: json['createdAt'] != null ? DateTime.tryParse(json['createdAt']) : null,
      updatedAt: json['updatedAt'] != null ? DateTime.tryParse(json['updatedAt']) : null,
      segments: json['segments'] != null 
          ? (json['segments'] as List).map((e) => Segment.fromJson(e as Map<String, dynamic>)).toList() 
          : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'tripId': tripId,
      'name': name,
      'description': description,
      'createdAt': createdAt?.toIso8601String(),
      'updatedAt': updatedAt?.toIso8601String(),
      'segments': segments?.map((e) => e.toJson()).toList(),
    };
  }
}
```

### Segment

```dart
class Segment {
  final int id;
  final int tripId;
  final int planId;
  final String name;
  final String? description;
  final DateTime startDate;
  final DateTime endDate;
  final double? coordsLat;
  final double? coordsLng;
  final String color;
  final bool flightBooked;
  final bool stayBooked;
  final bool isShengenRegion;
  final DateTime? createdAt;
  final DateTime? updatedAt;

  Segment({
    required this.id,
    required this.tripId,
    required this.planId,
    required this.name,
    this.description,
    required this.startDate,
    required this.endDate,
    this.coordsLat,
    this.coordsLng,
    required this.color,
    required this.flightBooked,
    required this.stayBooked,
    required this.isShengenRegion,
    this.createdAt,
    this.updatedAt,
  });

  factory Segment.fromJson(Map<String, dynamic> json) {
    return Segment(
      id: json['id'] as int,
      tripId: json['tripId'] as int,
      planId: json['planId'] as int,
      name: json['name'] as String,
      description: json['description'] as String?,
      startDate: DateTime.parse(json['startDate']),
      endDate: DateTime.parse(json['endDate']),
      coordsLat: (json['coordsLat'] as num?)?.toDouble(),
      coordsLng: (json['coordsLng'] as num?)?.toDouble(),
      color: json['color'] as String,
      flightBooked: json['flightBooked'] as bool? ?? false,
      stayBooked: json['stayBooked'] as bool? ?? false,
      isShengenRegion: json['isShengenRegion'] as bool? ?? false,
      createdAt: json['createdAt'] != null ? DateTime.tryParse(json['createdAt']) : null,
      updatedAt: json['updatedAt'] != null ? DateTime.tryParse(json['updatedAt']) : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'tripId': tripId,
      'planId': planId,
      'name': name,
      'description': description,
      'startDate': startDate.toIso8601String(),
      'endDate': endDate.toIso8601String(),
      'coordsLat': coordsLat,
      'coordsLng': coordsLng,
      'color': color,
      'flightBooked': flightBooked,
      'stayBooked': stayBooked,
      'isShengenRegion': isShengenRegion,
      'createdAt': createdAt?.toIso8601String(),
      'updatedAt': updatedAt?.toIso8601String(),
    };
  }
}
```

### Place

```dart
class Place {
  final int? id;
  final String name;
  final String? coverImageUrl;
  final DateTime? createdAt;
  final DateTime? updatedAt;

  Place({
    this.id,
    required this.name,
    this.coverImageUrl,
    this.createdAt,
    this.updatedAt,
  });

  factory Place.fromJson(Map<String, dynamic> json) {
    return Place(
      id: json['id'] as int?,
      name: json['name'] as String,
      coverImageUrl: json['coverImageUrl'] as String?,
      createdAt: json['createdAt'] != null ? DateTime.tryParse(json['createdAt']) : null,
      updatedAt: json['updatedAt'] != null ? DateTime.tryParse(json['updatedAt']) : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'name': name,
      'coverImageUrl': coverImageUrl,
      'createdAt': createdAt?.toIso8601String(),
      'updatedAt': updatedAt?.toIso8601String(),
    };
  }
}
```
